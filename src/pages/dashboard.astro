---
import Layout from '../layouts/Layout.astro';
import Home from '../components/Home.astro';
import "../styles/global.css"; 
---

<Layout title="Panel de Cursos | Cloud Academy">

  <div id="protected-content" class="hidden relative">
    
    <nav class="fixed top-4 right-4 z-50 flex items-center gap-3">
        
        <span id="user-greeting" class="text-slate-200 text-sm font-medium hidden md:block px-4 py-2 bg-slate-900/80 rounded-full backdrop-blur-md border border-slate-700 shadow-lg">
        </span>

        <button 
          id="logoutBtn"
          class="bg-red-600 hover:bg-red-700 text-white text-sm font-bold py-2 px-4 rounded-full shadow-lg transition cursor-pointer border border-red-500 hover:scale-105 active:scale-95"
        >
          Cerrar Sesi√≥n 
        </button>
    </nav>

    <Home />
    
  </div>
</Layout>

<script>

  const usuario = localStorage.getItem('usuario_logueado');
  const nombre = localStorage.getItem('nombre_usuario');
  
  const content = document.getElementById('protected-content');
  const greetingSpan = document.getElementById('user-greeting');
  const logoutBtn = document.getElementById('logoutBtn');

  if (!usuario) {

    window.location.href = '/';
  } else {

    if (content) content.classList.remove('hidden');

    if (nombre && greetingSpan) {
      greetingSpan.innerText = `Hola, ${nombre} üëã`;
    }
  }

  if (logoutBtn) {
      logoutBtn.addEventListener('click', () => {
        localStorage.removeItem('usuario_logueado');
        localStorage.removeItem('nombre_usuario');

        window.location.href = '/';
      });
  }
</script>